import{g as f,r as k,j as v,k as h,c as s,o as n,a as e,l,b as u,d as _,m as w,v as A,n as L,F as c,p as x,t as i,q as C,s as B}from"./BH7xsakx.js";import{u as N}from"./BPzreZ2E.js";import{R as T}from"./Dq_xLCce.js";import{c as U}from"./Iw-F9__c.js";const D=U("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),R={class:"flex items-center justify-between mb-6"},S={class:"mb-6 flex items-center gap-4"},V=["value"],F={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden"},I={class:"w-full"},j={class:"divide-y divide-gray-200 dark:divide-gray-700"},M={class:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400 whitespace-nowrap"},q={class:"px-6 py-4"},z={class:"px-6 py-4 text-sm text-gray-900 dark:text-white font-mono"},E={class:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400"},P={key:0,class:"text-xs bg-gray-100 dark:bg-gray-900 px-2 py-1 rounded"},H={key:1,class:"text-gray-400"},J={key:0},X=f({__name:"audit",setup(O){const o=N(),d=k(""),p=[{label:"All Actions",value:""},{label:"Disconnect Client",value:"disconnect_client"},{label:"Ban Client",value:"ban_client"},{label:"Unban Client",value:"unban_client"},{label:"Ban IP",value:"ban_ip"},{label:"Unban IP",value:"unban_ip"},{label:"Broadcast",value:"broadcast"},{label:"Update Rate Limits",value:"update_rate_limits"},{label:"Toggle Feature",value:"toggle_feature"}];v(()=>{o.fetchAuditLog()});const g=h(()=>d.value?o.auditLog.filter(r=>r.action===d.value):o.auditLog);function b(r){return new Date(r).toLocaleString()}function y(r){return r.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function m(r){return r.includes("ban")?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400":r.includes("unban")?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":r.includes("disconnect")?"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400":r.includes("broadcast")?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"bg-gray-100 dark:bg-gray-900/30 text-gray-700 dark:text-gray-400"}return(r,t)=>(n(),s("div",null,[e("div",R,[t[3]||(t[3]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Audit Log "),e("p",{class:"text-gray-600 dark:text-gray-400"}," Track administrative actions ")],-1)),e("button",{class:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",onClick:t[0]||(t[0]=(...a)=>l(o).fetchAuditLog&&l(o).fetchAuditLog(...a))},[u(l(T),{class:"h-4 w-4"}),t[2]||(t[2]=_(" Refresh ",-1))])]),e("div",S,[u(l(D),{class:"h-5 w-5 text-gray-400"}),w(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>L(d)?d.value=a:null),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"},[(n(),s(c,null,x(p,a=>e("option",{key:a.value,value:a.value},i(a.label),9,V)),64))],512),[[A,l(d)]])]),e("div",F,[e("table",I,[t[5]||(t[5]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Timestamp "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Action "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," User "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Details ")])],-1)),e("tbody",j,[(n(!0),s(c,null,x(l(g),a=>(n(),s("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("td",M,i(b(a.timestamp)),1),e("td",q,[e("span",{class:B(["px-2 py-1 rounded-full text-xs font-medium",m(a.action)])},i(y(a.action)),3)]),e("td",z,i(a.userId),1),e("td",E,[a.details?(n(),s("code",P,i(JSON.stringify(a.details)),1)):(n(),s("span",H,"-"))])]))),128)),l(g).length===0?(n(),s("tr",J,[...t[4]||(t[4]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500 dark:text-gray-400"}," No audit entries found ",-1)])])):C("",!0)])])])]))}});export{X as default};
