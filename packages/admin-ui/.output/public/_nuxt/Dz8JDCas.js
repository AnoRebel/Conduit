import{g as R,r as i,j as V,c as f,a as e,s as m,l as r,m as k,I as v,n as h,q as T,b as c,d as x,t as b,o as w}from"./BH7xsakx.js";import{a as j,u as S}from"./BPzreZ2E.js";import{c as y}from"./Iw-F9__c.js";const B=y("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);const D=y("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const C=y("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),E={class:"space-y-6"},I={class:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700"},N={class:"space-y-4"},K={class:"flex items-center justify-between"},q={class:"flex items-center gap-4"},H=["disabled"],P={class:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700"},z={class:"space-y-4"},F={class:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg"},U={class:"flex items-center gap-3"},Y={class:"text-xs text-gray-500 dark:text-gray-400"},Z={class:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-red-200 dark:border-red-800"},_={class:"space-y-4"},$={class:"flex items-center justify-between p-4 border border-red-200 dark:border-red-800 rounded-lg"},G={class:"flex items-center justify-between p-4 border border-red-200 dark:border-red-800 rounded-lg"},X=R({__name:"settings",setup(J){const o=j(),p=S(),s=i(!0),d=i(100),l=i(10),u=i(!1),n=i("");V(async()=>{try{const a=await o.getConfig();if(a.rateLimit){const t=a.rateLimit;s.value=t.enabled??!0,d.value=t.maxRequests??100}}catch{}});async function A(){u.value=!0,n.value="";try{await o.updateRateLimits({enabled:s.value,maxTokens:d.value,refillRate:l.value}),n.value="Rate limits updated successfully"}catch(a){n.value=a instanceof Error?a.message:"Failed to save settings"}finally{u.value=!1}}function M(){confirm("Clear stored API key? You will need to re-authenticate.")&&(localStorage.removeItem("adminApiKey"),window.location.reload())}async function L(){if(confirm("Clear all bans? This cannot be undone."))try{await o.fetchApi("/bans",{method:"DELETE"}),await p.fetchBans()}catch{}}return(a,t)=>(w(),f("div",null,[t[17]||(t[17]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Settings "),e("p",{class:"text-gray-600 dark:text-gray-400"}," Configure server and admin settings ")],-1)),e("div",E,[e("div",I,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," Rate Limiting ",-1)),e("div",N,[e("div",K,[t[4]||(t[4]=e("div",null,[e("label",{class:"text-sm font-medium text-gray-900 dark:text-white"}," Enable Rate Limiting "),e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," Limit the number of messages per client ")],-1)),e("button",{class:m(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",r(s)?"bg-primary-600":"bg-gray-200 dark:bg-gray-700"]),onClick:t[0]||(t[0]=g=>s.value=!r(s))},[e("span",{class:m(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",r(s)?"translate-x-5":"translate-x-0"])},null,2)],2)]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-1"}," Max Tokens ",-1)),k(e("input",{"onUpdate:modelValue":t[1]||(t[1]=g=>h(d)?d.value=g:null),type:"number",min:"1",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"},null,512),[[v,r(d),void 0,{number:!0}]]),t[6]||(t[6]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"}," Maximum number of tokens in the bucket ",-1))]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-1"}," Refill Rate ",-1)),k(e("input",{"onUpdate:modelValue":t[2]||(t[2]=g=>h(l)?l.value=g:null),type:"number",min:"1",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"},null,512),[[v,r(l),void 0,{number:!0}]]),t[8]||(t[8]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"}," Tokens added per second ",-1))]),e("div",q,[e("button",{class:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50",disabled:r(u),onClick:A},[c(r(D),{class:"h-4 w-4"}),x(" "+b(r(u)?"Saving...":"Save Changes"),1)],8,H),r(n)?(w(),f("span",{key:0,class:m(["text-sm",r(n).includes("success")?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"])},b(r(n)),3)):T("",!0)])])]),e("div",P,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," Authentication ",-1)),e("div",z,[e("div",F,[e("div",U,[c(r(B),{class:"h-5 w-5 text-gray-400"}),e("div",null,[t[10]||(t[10]=e("p",{class:"text-sm font-medium text-gray-900 dark:text-white"}," API Key ",-1)),e("p",Y,b(r(o).isAuthenticated.value?"Configured":"Not configured"),1)])]),e("button",{class:"px-3 py-1.5 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",onClick:M}," Clear ")])])]),e("div",Z,[t[16]||(t[16]=e("h3",{class:"text-lg font-semibold text-red-600 dark:text-red-400 mb-4"}," Danger Zone ",-1)),e("div",_,[e("div",$,[t[13]||(t[13]=e("div",null,[e("p",{class:"text-sm font-medium text-gray-900 dark:text-white"}," Clear All Bans "),e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," Remove all client and IP bans ")],-1)),e("button",{class:"flex items-center gap-2 px-3 py-1.5 text-sm text-red-600 dark:text-red-400 border border-red-300 dark:border-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",onClick:L},[c(r(C),{class:"h-4 w-4"}),t[12]||(t[12]=x(" Clear Bans ",-1))])]),e("div",G,[t[15]||(t[15]=e("div",null,[e("p",{class:"text-sm font-medium text-gray-900 dark:text-white"}," Disconnect All Clients "),e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," Force disconnect all connected clients ")],-1)),e("button",{class:"flex items-center gap-2 px-3 py-1.5 text-sm text-red-600 dark:text-red-400 border border-red-300 dark:border-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",onClick:t[3]||(t[3]=async()=>{a.confirm("Disconnect all clients?")&&(await r(o).disconnectAllClients(),await r(p).fetchClients())})},[c(r(C),{class:"h-4 w-4"}),t[14]||(t[14]=x(" Disconnect All ",-1))])])])])])]))}});export{X as default};
